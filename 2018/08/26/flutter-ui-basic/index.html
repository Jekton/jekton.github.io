<!DOCTYPE html><html lang="zh-CN"><head><meta name="generator" content="Hexo 3.9.0"><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><title>Flutter 开发（2）- UI控件和布局 | 程序员虾饺</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/8.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">Flutter 开发（2）- UI控件和布局</h1><a id="logo" href="/.">程序员虾饺</a><p class="description"></p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a><a href="/atom.xml"><i class="fa fa-rss"> 订阅</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">Flutter 开发（2）- UI控件和布局</h1><div class="post-meta">Aug 26, 2018<span> | </span><span class="category"><a href="/categories/Flutter/">Flutter</a></span><script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> 阅读</span></span></div><a class="disqus-comment-count" data-disqus-identifier="2018/08/26/flutter-ui-basic/" href="/2018/08/26/flutter-ui-basic/#disqus_thread"></a><div class="post-content"><blockquote>
<p>本文由<a href="http://renyugang.io/post/75" target="_blank" rel="noopener">玉刚说写作平台</a>提供写作赞助<br>赞助金额：200元<br>原作者：<code>水晶虾饺</code><br>版权声明：本文版权归微信公众号<code>玉刚说</code>所有，未经许可，不得以任何形式转载</p>
</blockquote>
<p>本篇文章我们先介绍 Flutter 里一些常用的 UI 控件，然后借助官网提供的两个 demo 把所学的控件知识实际使用起来。</p>
<h1 id="基本控件"><a href="#基本控件" class="headerlink" title="基本控件"></a>基本控件</h1><h2 id="Widget"><a href="#Widget" class="headerlink" title="Widget"></a>Widget</h2><p>在 Flutter 里，UI 控件就是所谓的 Widget。通过组合不同的 Widget，来实现我们用户交互界面。</p>
<p>Widget 分为两种，一种是无状态的，叫 <code>StatelessWidget</code>，它只能用来展示信息，不能有动作（用户交互）；另一种是有状态的，叫 <code>StatefulWidget</code>，这种 Widget 可以通过改变状态使得 UI 发生变化，它可以包含用户交互。</p>
<p><code>StatelessWidget</code> 的使用非常简单，我们只需要继承 <code>StatelessWidget</code>，然后实现 <code>build</code> 方法就可以了：</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FooWidget</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>关于 <code>build</code> 方法的实现，在后面我们学习具体的控件时读者就会了解的，这里暂时忽略掉。</p>
<p><code>StatefulWidget</code> 用起来麻烦一些，他还需要一个 <code>State</code>：</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BarWidget</span> <span class="keyword">extends</span> <span class="title">StatefulWidget</span> </span>&#123;</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  State createState() &#123;</span><br><span class="line">    <span class="keyword">return</span> _BarWidgetState();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">_BarWidgetState</span> <span class="keyword">extends</span> <span class="title">State</span>&lt;<span class="title">BarWidget</span>&gt; </span>&#123;</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这里看起来可能有些绕，<code>BarWidget</code> 依赖了 <code>_BarWidgetState</code>，而 <code>_BarWidgetState</code> 又继承了 <code>State&lt;
BarWidget&gt;</code>。如果读者不太理解，其实也没有什么关系，这只是一个样板代码，照着写就行了。</p>
<p>从 <code>BarWidget</code> 的实现来看，好像跟前面使用 <code>StatelessWidget</code> 没有什么区别，都是在 <code>build</code> 方法里面返回一个 <code>Widget</code>，只是 stateful widget 把这个方法挪到了 <code>State</code> 里面。实际上，两者的区别非常大。stateless widget 整个生命周期里都不会改变，所以 <code>build</code> 方法只会执行一次。而 stateful widget 只要状态改变，就会调用 <code>build</code> 方法重新创建 UI。</p>
<p>为了触发 UI 的重建，我们可以调用 <code>setState</code> 方法。下面的代码读者留意一下即可，在后面我们学习了相关的控件后再回过头来看。</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BarWidget</span> <span class="keyword">extends</span> <span class="title">StatefulWidget</span> </span>&#123;</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  State createState() &#123;</span><br><span class="line">    <span class="keyword">return</span> _BarWidgetState();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">_BarWidgetState</span> <span class="keyword">extends</span> <span class="title">State</span>&lt;<span class="title">BarWidget</span>&gt; </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> i = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> Row(</span><br><span class="line">      children: &lt;Widget&gt;[</span><br><span class="line">        Text(<span class="string">'i = $i'</span>),</span><br><span class="line">        RaisedButton(</span><br><span class="line">          onPressed: () &#123;</span><br><span class="line">            setState(() &#123;</span><br><span class="line">              ++i;</span><br><span class="line">            &#125;);</span><br><span class="line">          &#125;,</span><br><span class="line">          child: Text(<span class="string">'click'</span>),</span><br><span class="line">        )</span><br><span class="line">      ],</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>下面我们开始学习一些具体的控件。</p>
<h2 id="文本"><a href="#文本" class="headerlink" title="文本"></a>文本</h2><p>为了展示文本，我们使用 <code>Text</code>：</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TestWidget</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> Text(<span class="string">"Put your text here"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这就是最简单的文本了，它使用的是默认的样式。很多情况下，我们都需要对文本的样式进行修改，这个时候，可以使用 <code>TextStyle</code>：</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TestWidget</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> Text(</span><br><span class="line">      <span class="string">"Put your text here"</span>,</span><br><span class="line">      style: TextStyle(</span><br><span class="line">        color: Colors.blue,</span><br><span class="line">        fontSize: <span class="number">16.0</span>,</span><br><span class="line">        fontWeight: FontWeight.bold</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="图片"><a href="#图片" class="headerlink" title="图片"></a>图片</h2><p>使用 <code>Image</code>，可以让我们向用户展示一张图片。图片的来源可以是网络、文件、资源和内存，它们对应的构造函数分别是：</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Image.asset(name);</span><br><span class="line">Image.file(file);</span><br><span class="line">Image.memory(bytes);</span><br><span class="line">Image.network(src);</span><br></pre></td></tr></table></figure>

<p>比方说，为了展示一张来自网络的图片，我们可以这样：</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TestWidget</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> Image.network(</span><br><span class="line">      <span class="string">"http://www.example.com/xxx.png"</span>,</span><br><span class="line">      width: <span class="number">200.0</span>,</span><br><span class="line">      height: <span class="number">150.0</span>,</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="按钮"><a href="#按钮" class="headerlink" title="按钮"></a>按钮</h2><p>Flutter 提供了两个基本的按钮控件：<code>FlatButton</code> 和 <code>RaisedButton</code>，它们的使用方法是类似的：</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TestWidget</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">var</span> flatBtn = FlatButton(</span><br><span class="line">      onPressed: () =&gt; <span class="built_in">print</span>(<span class="string">'FlatButton pressed'</span>),</span><br><span class="line">      child: Text(<span class="string">'BUTTON'</span>),</span><br><span class="line">    );</span><br><span class="line">    <span class="keyword">var</span> raisedButton = RaisedButton(</span><br><span class="line">      onPressed: () =&gt; <span class="built_in">print</span>(<span class="string">'RaisedButton pressed'</span>),</span><br><span class="line">      child: Text(<span class="string">'BUTTON'</span>),</span><br><span class="line">    );</span><br><span class="line">    <span class="keyword">return</span> raisedButton;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>通过设置 <code>onPressed</code> 回调，我们可以在按钮被点击的时候得到回调。<code>child</code> 参数用于设置按钮的内容。虽然我们给 <code>child</code> 传递的是 <code>Text</code>，但这不是必需的，它可以接受任意的 <code>Widget</code>，比方说，<code>Image</code>。</p>
<p>注意，由于我们只是在按钮点击的时候打印一个字符串，这里使用 <code>StatelessWidget</code> 是没有问题的。但如果有其他 UI 动作（比如弹出一个 dialog，则必须使用 <code>StatefulWidget</code>）。</p>
<p>它们的区别只是样式不同而已的：</p>
<p><code>FlatButton</code>：<br><img src="/2018/08/26/flutter-ui-basic/flat-button.png" alt=""></p>
<p><code>RaiseButton</code>：<br><img src="/2018/08/26/flutter-ui-basic/raised-button.png" alt=""></p>
<h2 id="文本输入框"><a href="#文本输入框" class="headerlink" title="文本输入框"></a>文本输入框</h2><p>Flutter 的文本输入框叫 <code>TextField</code>。为了获取用户输入的文本，我们需要给他设置一个 controller。通过这个 controller，就可以拿到文本框里的内容：</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MessageForm</span> <span class="keyword">extends</span> <span class="title">StatefulWidget</span> </span>&#123;</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  State createState() &#123;</span><br><span class="line">    <span class="keyword">return</span> _MessageFormState();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">_MessageFormState</span> <span class="keyword">extends</span> <span class="title">State</span>&lt;<span class="title">MessageForm</span>&gt; </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> editController = TextEditingController();</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="comment">// Row、Expand 都是用于布局的控件，这里可以先忽略它们</span></span><br><span class="line">    <span class="keyword">return</span> Row(</span><br><span class="line">      children: &lt;Widget&gt;[</span><br><span class="line">        Expanded(</span><br><span class="line">          child: TextField(</span><br><span class="line">            controller: editController,</span><br><span class="line">          ),</span><br><span class="line">        ),</span><br><span class="line">        RaisedButton(</span><br><span class="line">          child: Text(<span class="string">"click"</span>),</span><br><span class="line">          onPressed: () =&gt; <span class="built_in">print</span>(<span class="string">'text inputted: <span class="subst">$&#123;editController.text&#125;</span>'</span>),</span><br><span class="line">        )</span><br><span class="line">      ],</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  <span class="keyword">void</span> dispose() &#123;</span><br><span class="line">    <span class="keyword">super</span>.dispose();</span><br><span class="line">    <span class="comment">// 手动调用 controller 的 dispose 方法以释放资源</span></span><br><span class="line">    editController.dispose();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="显示弹框"><a href="#显示弹框" class="headerlink" title="显示弹框"></a>显示弹框</h2><p>在前面的 <code>TextField</code> 例子中，我们只是把用户的输入通过 <code>print</code> 打印出来，这未免也太无趣了。在这一小节，我们要把它显示在 dialog 里。为了弹出一个 dialog，我们需要调用 <code>showDialog</code> 方法并传递一个 builder：</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">_MessageFormState</span> <span class="keyword">extends</span> <span class="title">State</span>&lt;<span class="title">MessageForm</span>&gt; </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> editController = TextEditingController();</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> Row(</span><br><span class="line">      children: &lt;Widget&gt;[</span><br><span class="line">        Expanded(</span><br><span class="line">          child: TextField(</span><br><span class="line">            controller: editController,</span><br><span class="line">          ),</span><br><span class="line">        ),</span><br><span class="line">        RaisedButton(</span><br><span class="line">          child: Text(<span class="string">"click"</span>),</span><br><span class="line">          onPressed: () &#123;</span><br><span class="line">            showDialog(</span><br><span class="line">                <span class="comment">// 第一个 context 是参数名，第二个 context 是 State 的成员变量</span></span><br><span class="line">                context: context,</span><br><span class="line">                builder: (_) &#123;</span><br><span class="line">                  <span class="keyword">return</span> AlertDialog(</span><br><span class="line">                    <span class="comment">// dialog 的内容</span></span><br><span class="line">                    content: Text(editController.text),</span><br><span class="line">                    <span class="comment">// actions 设置 dialog 的按钮</span></span><br><span class="line">                    actions: &lt;Widget&gt;[</span><br><span class="line">                      FlatButton(</span><br><span class="line">                        child: Text(<span class="string">'OK'</span>),</span><br><span class="line">                        <span class="comment">// 用户点击按钮后，关闭弹框</span></span><br><span class="line">                        onPressed: () =&gt; Navigator.pop(context),</span><br><span class="line">                      )</span><br><span class="line">                    ],</span><br><span class="line">                  );</span><br><span class="line">                &#125;</span><br><span class="line">            );</span><br><span class="line">          &#125;</span><br><span class="line">        )</span><br><span class="line">      ],</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  <span class="keyword">void</span> dispose() &#123;</span><br><span class="line">    <span class="keyword">super</span>.dispose();</span><br><span class="line">    editController.dispose();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="最简单的布局——Container、Padding-和-Center："><a href="#最简单的布局——Container、Padding-和-Center：" class="headerlink" title="最简单的布局——Container、Padding 和 Center："></a>最简单的布局——Container、Padding 和 Center：</h2><p>我们经常说，Flutter 里面所有的东西都是 Widget，所以，布局也是 Widget。</p>
<p>控件 <code>Container</code> 可以让我们设置一个控件的尺寸、背景、margin 等：</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TestWidget</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> Container(</span><br><span class="line">      child: Text(<span class="string">'text'</span>),</span><br><span class="line">      padding: EdgeInsets.all(<span class="number">8.0</span>),</span><br><span class="line">      margin: EdgeInsets.all(<span class="number">4.0</span>),</span><br><span class="line">      width: <span class="number">80.0</span>,</span><br><span class="line">      decoration: BoxDecoration(</span><br><span class="line">        <span class="comment">// 背景色</span></span><br><span class="line">        color: Colors.grey,</span><br><span class="line">        <span class="comment">// 圆角</span></span><br><span class="line">        borderRadius: BorderRadius.circular(<span class="number">5.0</span>),</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>如果我们只需要 padding，可以使用控件 <code>Padding</code>：</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TestWidget</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> Padding(</span><br><span class="line">      padding: EdgeInsets.all(<span class="number">8.0</span>),</span><br><span class="line">      child: Text(<span class="string">'text'</span>),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>Center</code> 就跟它的名字一样，把一个控件放在中间：</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TestWidget</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> Container(</span><br><span class="line">      padding: EdgeInsets.all(<span class="number">8.0</span>),</span><br><span class="line">      margin: EdgeInsets.all(<span class="number">4.0</span>),</span><br><span class="line">      width: <span class="number">200.0</span>,</span><br><span class="line">      height: <span class="number">200.0</span>,</span><br><span class="line">      decoration: BoxDecoration(</span><br><span class="line">        <span class="comment">// 背景色</span></span><br><span class="line">        color: Colors.grey,</span><br><span class="line">        <span class="comment">// 圆角</span></span><br><span class="line">        borderRadius: BorderRadius.circular(<span class="number">5.0</span>),</span><br><span class="line">      ),</span><br><span class="line"></span><br><span class="line">      <span class="comment">// 把文本放在 Container 的中间</span></span><br><span class="line">      child: Center(</span><br><span class="line">        child: Text(<span class="string">'text'</span>),</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="水平、竖直布局和-Expand"><a href="#水平、竖直布局和-Expand" class="headerlink" title="水平、竖直布局和 Expand"></a>水平、竖直布局和 Expand</h2><p>我们经常说，Flutter 里面所有的东西都是 <code>Widget</code>，所以，布局也是 <code>Widget</code>。水平布局我们可以使用 <code>Row</code>，竖直布局使用 <code>Column</code>。</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TestWidget</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> Row(</span><br><span class="line">      <span class="comment">// 只有一个子元素的 widget，一般使用 child 参数来设置；Row 可以包含多个子控件，</span></span><br><span class="line">      <span class="comment">// 对应的则是 children。</span></span><br><span class="line">      children: &lt;Widget&gt;[</span><br><span class="line">        Text(<span class="string">'text1'</span>),</span><br><span class="line">        Text(<span class="string">'text2'</span>),</span><br><span class="line">        Text(<span class="string">'text3'</span>),</span><br><span class="line">        Text(<span class="string">'text4'</span>),</span><br><span class="line">      ],</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>Column</code> 的使用是一样的：</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TestWidget</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> Column(</span><br><span class="line">      children: &lt;Widget&gt;[</span><br><span class="line">        Text(<span class="string">'text1'</span>),</span><br><span class="line">        Text(<span class="string">'text2'</span>),</span><br><span class="line">        Text(<span class="string">'text3'</span>),</span><br><span class="line">        Text(<span class="string">'text4'</span>),</span><br><span class="line">      ],</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>关于 <code>Expand</code> 控件，我们来看看 <code>TextField</code> 的那个例子：</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MessageForm</span> <span class="keyword">extends</span> <span class="title">StatefulWidget</span> </span>&#123;</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  State createState() &#123;</span><br><span class="line">    <span class="keyword">return</span> _MessageFormState();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">_MessageFormState</span> <span class="keyword">extends</span> <span class="title">State</span>&lt;<span class="title">MessageForm</span>&gt; </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> editController = TextEditingController();</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> Row(</span><br><span class="line">      children: &lt;Widget&gt;[</span><br><span class="line">        <span class="comment">// 占满一行里除 RaisedButton 外的所有空间</span></span><br><span class="line">        Expanded(</span><br><span class="line">          child: TextField(</span><br><span class="line">            controller: editController,</span><br><span class="line">          ),</span><br><span class="line">        ),</span><br><span class="line">        RaisedButton(</span><br><span class="line">          child: Text(<span class="string">"click"</span>),</span><br><span class="line">          onPressed: () =&gt; <span class="built_in">print</span>(<span class="string">'text inputted: <span class="subst">$&#123;editController.text&#125;</span>'</span>),</span><br><span class="line">        )</span><br><span class="line">      ],</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  <span class="keyword">void</span> dispose() &#123;</span><br><span class="line">    <span class="keyword">super</span>.dispose();</span><br><span class="line">    editController.dispose();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这里通过使用 <code>Expand</code>，<code>TextField</code> 才能够占满一行里除按钮外的所有空间。此外，当一行/列里有多个 <code>Expand</code> 时，我们还可以通过设置它的 <code>flex</code> 参数，在多个 <code>Expand</code> 之间按比例划分可用空间。</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TestWidget</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> Row(</span><br><span class="line">      children: &lt;Widget&gt;[</span><br><span class="line">        Expanded(</span><br><span class="line">          <span class="comment">// 占一行的 2/3</span></span><br><span class="line">          flex: <span class="number">2</span>,</span><br><span class="line">          child: RaisedButton(child: Text(<span class="string">'btn1'</span>),),</span><br><span class="line">        ),</span><br><span class="line">        Expanded(</span><br><span class="line">          <span class="comment">// 占一行的 1/3</span></span><br><span class="line">          flex: <span class="number">1</span>,</span><br><span class="line">          child: RaisedButton(child: Text(<span class="string">'btn2'</span>),),</span><br><span class="line">        ),</span><br><span class="line">      ],</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Stack-布局"><a href="#Stack-布局" class="headerlink" title="Stack 布局"></a>Stack 布局</h2><p>有些时候，我们可能会希望一个控件叠在另一个控件的上面。于是，<code>Stack</code> 应运而生：</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TestWidget</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> Stack(</span><br><span class="line">      children: &lt;Widget&gt;[</span><br><span class="line">        Text(<span class="string">'foobar'</span>),</span><br><span class="line">        Text(<span class="string">'barfoo'</span>),</span><br><span class="line">      ],</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>默认情况下，子控件都按 <code>Stack</code> 的左上角对齐，于是，上面的两个文本完全一上一下堆叠在一起。我们还可以通过设置 <code>alignment</code> 参数来改变这个对齐的位置：</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TestWidget</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> Stack(</span><br><span class="line">      <span class="comment">// Aligment 的取值范围为 [-1, 1]，Stack 中心为 (0, 0)，</span></span><br><span class="line">      <span class="comment">// 这里设置为 (-0.5, -0.5) 后，可以让文本对齐到 Container 的 1/4 处</span></span><br><span class="line">      alignment: <span class="keyword">const</span> Alignment(<span class="number">-0.5</span>, <span class="number">-0.5</span>),</span><br><span class="line">      children: &lt;Widget&gt;[</span><br><span class="line">        Container(</span><br><span class="line">          width: <span class="number">200.0</span>,</span><br><span class="line">          height: <span class="number">200.0</span>,</span><br><span class="line">          color: Colors.blue,</span><br><span class="line">        ),</span><br><span class="line">        Text(<span class="string">'foobar'</span>),</span><br><span class="line">      ],</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2018/08/26/flutter-ui-basic/screenshot-stack.png" alt="screenshot-stack"></p>
<p>通过组合 Row/Column 和 Stack，已经能够完成绝大部分的布局了，所以 Flutter 里没有相对布局之类的东西。更多的 Flutter 控件，读者可以参考 <a href="https://flutter.io/widgets/" target="_blank" rel="noopener">https://flutter.io/widgets/</a>。</p>
<h1 id="示例一"><a href="#示例一" class="headerlink" title="示例一"></a>示例一</h1><p>在这一节里，我们综合前面所学的知识，来实现下面这个界面。</p>
<p><img src="/2018/08/26/flutter-ui-basic/lakes-diagram.png" alt="lakes-diagram"></p>
<h2 id="展示图片"><a href="#展示图片" class="headerlink" title="展示图片"></a>展示图片</h2><ol>
<li><p>把图片 <a href="lake.png">lake</a> 放到项目根目录的 <code>images</code> 文件夹下（如果没有，你需要自己创建一个）</p>
</li>
<li><p>修改 <code>pubspec.yaml</code>，找到下面这个地方，然后把图片加进来</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">flutter:</span><br><span class="line"></span><br><span class="line">  # The following line ensures that the Material Icons font is</span><br><span class="line">  # included with your application, so that you can use the icons in</span><br><span class="line">  # the material Icons class.</span><br><span class="line">  uses-material-design: true</span><br><span class="line"></span><br><span class="line">  # To add assets to your application, add an assets section, like this:</span><br><span class="line">  # assets:</span><br><span class="line">  #  - images/a_dot_burr.jpeg</span><br><span class="line">  #  - images/a_dot_ham.jpeg</span><br></pre></td></tr></table></figure>

<p> 修改后如下：</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">flutter:</span><br><span class="line"></span><br><span class="line">  # The following line ensures that the Material Icons font is</span><br><span class="line">  # included with your application, so that you can use the icons in</span><br><span class="line">  # the material Icons class.</span><br><span class="line">  uses-material-design: true</span><br><span class="line"></span><br><span class="line">  # To add assets to your application, add an assets section, like this:</span><br><span class="line">  assets:</span><br><span class="line">    - images/lake.jpg</span><br></pre></td></tr></table></figure>
</li>
<li><p>现在，我们可以把这张图片展示出来了：</p>
 <figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> main() &#123;</span><br><span class="line">  runApp(MyApp());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyApp</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> MaterialApp(</span><br><span class="line">      title: <span class="string">'Flutter UI basic 1'</span>,</span><br><span class="line">      home: Scaffold(</span><br><span class="line">        appBar: AppBar(</span><br><span class="line">          title: Text(<span class="string">'Top Lakes'</span>),</span><br><span class="line">        ),</span><br><span class="line">        body: Image.asset(</span><br><span class="line">          <span class="string">'images/lake.jpg'</span>,</span><br><span class="line">          width: <span class="number">600.0</span>,</span><br><span class="line">          height: <span class="number">240.0</span>,</span><br><span class="line">          <span class="comment">// cover 类似于 Android 开发中的 centerCrop，其他一些类型，读者可以查看</span></span><br><span class="line">          <span class="comment">// https://docs.flutter.io/flutter/painting/BoxFit-class.html</span></span><br><span class="line">          fit: BoxFit.cover,</span><br><span class="line">        )</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ol>
<p>如果读者是初学 Flutter，<strong>强烈建议</strong>在遇到不熟悉的 API 时翻一翻文档，并在文档中找到 demo 所使用的 API。我们的例子不可能覆盖所有的 API，通过这种方式熟悉文档后，读者就可以根据文档实现出自己想要的效果。不妨就从 <code>Image</code> 开始吧，在 <a href="https://docs.flutter.io/flutter/widgets/Image/Image.asset.html" target="_blank" rel="noopener">https://docs.flutter.io/flutter/widgets/Image/Image.asset.html</a> 找出上面我们使用的 <code>Image.asset</code> 构造函数的几个参数的含义，还有 <code>BoxFit</code> 的其他几个枚举值。</p>
<h2 id="布局"><a href="#布局" class="headerlink" title="布局"></a>布局</h2><p>在这一小节，我们来实现图片下方的标题区域。</p>
<p><img src="/2018/08/26/flutter-ui-basic/title-section-diagram.png" alt=""></p>
<p>我们直接来看代码：</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">_TitleSection</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="keyword">final</span> <span class="built_in">String</span> title;</span><br><span class="line">  <span class="keyword">final</span> <span class="built_in">String</span> subtitle;</span><br><span class="line">  <span class="keyword">final</span> <span class="built_in">int</span> starCount;</span><br><span class="line"></span><br><span class="line">  _TitleSection(<span class="keyword">this</span>.title, <span class="keyword">this</span>.subtitle, <span class="keyword">this</span>.starCount);</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="comment">// 为了给 title section 加上 padding，这里我们给内容套一个 Container</span></span><br><span class="line">    <span class="keyword">return</span> Container(</span><br><span class="line">      <span class="comment">// 设置上下左右的 padding 都是 32。类似的还有 EdgeInsets.only/symmetric 等</span></span><br><span class="line">      padding: EdgeInsets.all(<span class="number">32.0</span>),</span><br><span class="line">      child: Row(</span><br><span class="line">        children: &lt;Widget&gt;[</span><br><span class="line">          <span class="comment">// 这里为了让标题占满屏幕宽度的剩余空间，用 Expanded 把标题包了起来</span></span><br><span class="line">          Expanded(</span><br><span class="line">            <span class="comment">// 再次提醒读者，Expanded 只能包含一个子元素，使用的参数名是 child。接下来，</span></span><br><span class="line">            <span class="comment">// 为了在竖直方向放两个标题，加入一个 Column。</span></span><br><span class="line">            child: Column(</span><br><span class="line">              <span class="comment">// Column 是竖直方向的，cross 为交叉的意思，也就是说，这里设置的是水平方向</span></span><br><span class="line">              <span class="comment">// 的对齐。在水平方向，我们让文本对齐到 start（读者可以修改为 end 看看效果）</span></span><br><span class="line">              crossAxisAlignment: CrossAxisAlignment.start,</span><br><span class="line">              children: &lt;Widget&gt;[</span><br><span class="line">                <span class="comment">// 聪明的你，这个时候肯定知道为什么突然加入一个 Container 了。</span></span><br><span class="line">                <span class="comment">// 跟前面一样，只是为了设置一个 padding</span></span><br><span class="line">                Container(</span><br><span class="line">                  padding: <span class="keyword">const</span> EdgeInsets.only(bottom: <span class="number">8.0</span>),</span><br><span class="line">                  child: Text(</span><br><span class="line">                    title,</span><br><span class="line">                    style: TextStyle(fontWeight: FontWeight.bold),</span><br><span class="line">                  ),</span><br><span class="line">                ),</span><br><span class="line">                Text(</span><br><span class="line">                  subtitle,</span><br><span class="line">                  style: TextStyle(color: Colors.grey[<span class="number">500</span>]),</span><br><span class="line">                )</span><br><span class="line">              ],</span><br><span class="line">            ),</span><br><span class="line">          ),</span><br><span class="line"></span><br><span class="line">          <span class="comment">// 这里是 Row 的第二个子元素，下面这两个就没用太多值得说的东西了。</span></span><br><span class="line">          Icon(</span><br><span class="line">            Icons.star,</span><br><span class="line">            color: Colors.red[<span class="number">500</span>],</span><br><span class="line">          ),</span><br><span class="line"></span><br><span class="line">          Text(starCount.toString())</span><br><span class="line">        ],</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="对齐"><a href="#对齐" class="headerlink" title="对齐"></a>对齐</h2><p>接下来我们要做的这一部分在布局上所用到的知识，基本知识在上一小节我们都已经学习了。这里唯一的区别在于，三个按钮是水平分布的。</p>
<p><img src="/2018/08/26/flutter-ui-basic/button-section-diagram.png" alt=""></p>
<p>实现如下：</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">Widget _buildButtonColumn(BuildContext context, IconData icon, <span class="built_in">String</span> label) &#123;</span><br><span class="line">  <span class="keyword">final</span> color = Theme.of(context).primaryColor;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> Column(</span><br><span class="line">    <span class="comment">// main axis 跟我们前面提到的 cross axis 相对应，对 Column 来说，指的就是竖直方向。</span></span><br><span class="line">    <span class="comment">// 在放置完子控件后，屏幕上可能还会有一些剩余的空间（free space），min 表示尽量少占用</span></span><br><span class="line">    <span class="comment">// free space；类似于 Android 的 wrap_content。</span></span><br><span class="line">    <span class="comment">// 对应的，还有 MainAxisSize.max</span></span><br><span class="line">    mainAxisSize: MainAxisSize.min,</span><br><span class="line">    <span class="comment">// 沿着 main axis 居中放置</span></span><br><span class="line">    mainAxisAlignment: MainAxisAlignment.center,</span><br><span class="line"></span><br><span class="line">    children: &lt;Widget&gt;[</span><br><span class="line">      Icon(icon, color: color),</span><br><span class="line">      Container(</span><br><span class="line">        margin: <span class="keyword">const</span> EdgeInsets.only(top: <span class="number">8.0</span>),</span><br><span class="line">        child: Text(</span><br><span class="line">          label,</span><br><span class="line">          style: TextStyle(</span><br><span class="line">            fontSize: <span class="number">12.0</span>,</span><br><span class="line">            fontWeight: FontWeight.w400,</span><br><span class="line">            color: color,</span><br><span class="line">          ),</span><br><span class="line">        ),</span><br><span class="line">      )</span><br><span class="line">    ],</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyApp</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line"></span><br><span class="line">    Widget buttonSection = Container(</span><br><span class="line">      child: Row(</span><br><span class="line">        <span class="comment">// 沿水平方向平均放置</span></span><br><span class="line">        mainAxisAlignment: MainAxisAlignment.spaceEvenly,</span><br><span class="line">        children: [</span><br><span class="line">          _buildButtonColumn(context, Icons.call, <span class="string">'CALL'</span>),</span><br><span class="line">          _buildButtonColumn(context, Icons.near_me, <span class="string">'ROUTE'</span>),</span><br><span class="line">          _buildButtonColumn(context, Icons.share, <span class="string">'SHARE'</span>),</span><br><span class="line">        ],</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  <span class="comment">//...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>关于 cross/main axis，看看下面这两个图就很清楚了：<br><img src="/2018/08/26/flutter-ui-basic/column-diagram.png" alt=""><br><img src="/2018/08/26/flutter-ui-basic/row-diagram.png" alt=""></p>
<p><code>MainAxisAlignment</code> 的更多的信息，可以查看 <a href="https://docs.flutter.io/flutter/rendering/MainAxisAlignment-class.html" target="_blank" rel="noopener">https://docs.flutter.io/flutter/rendering/MainAxisAlignment-class.html</a>。</p>
<h2 id="全部放到一起"><a href="#全部放到一起" class="headerlink" title="全部放到一起"></a>全部放到一起</h2><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyApp</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">final</span> titleSection = _TitleSection(</span><br><span class="line">        <span class="string">'Oeschinen Lake Campground'</span>, <span class="string">'Kandersteg, Switzerland'</span>, <span class="number">41</span>);</span><br><span class="line">    <span class="keyword">final</span> buttonSection = ...;</span><br><span class="line">    <span class="keyword">final</span> textSection = Container(</span><br><span class="line">        padding: <span class="keyword">const</span> EdgeInsets.all(<span class="number">32.0</span>),</span><br><span class="line">        child: Text(</span><br><span class="line">          <span class="string">'''</span></span><br><span class="line"><span class="string">Lake Oeschinen lies at the foot of the Blüemlisalp in the Bernese Alps. Situated 1,578 meters above sea level, it is one of the larger Alpine Lakes. A gondola ride from Kandersteg, followed by a half-hour walk through pastures and pine forest, leads you to the lake, which warms to 20 degrees Celsius in the summer. Activities enjoyed here include rowing, and riding the summer toboggan run.</span></span><br><span class="line"><span class="string">          '''</span>,</span><br><span class="line">          softWrap: <span class="keyword">true</span>,</span><br><span class="line">        ),</span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> MaterialApp(</span><br><span class="line">      title: <span class="string">'Flutter UI basic 1'</span>,</span><br><span class="line">      home: Scaffold(</span><br><span class="line">          appBar: AppBar(</span><br><span class="line">            title: Text(<span class="string">'Top Lakes'</span>),</span><br><span class="line">          ),</span><br><span class="line">          <span class="comment">// 由于我们的内容可能会超出屏幕的长度，这里把内容都放到 ListView 里。</span></span><br><span class="line">          <span class="comment">// 除了这种用法，ListView 也可以像我们在 Android 原生开发中使用 ListView 那样，</span></span><br><span class="line">          <span class="comment">// 根据数据动态生成一个个 item。这个我们在下一节再来学习</span></span><br><span class="line">          body: ListView(</span><br><span class="line">            children: &lt;Widget&gt;[</span><br><span class="line">              Image.asset(</span><br><span class="line">                <span class="string">'images/lake.jpg'</span>,</span><br><span class="line">                width: <span class="number">600.0</span>,</span><br><span class="line">                height: <span class="number">240.0</span>,</span><br><span class="line">                <span class="comment">// cover 类似于 Android 开发中的 centerCrop，其他一些类型，读者可以查看</span></span><br><span class="line">                <span class="comment">// https://docs.flutter.io/flutter/painting/BoxFit-class.html</span></span><br><span class="line">                fit: BoxFit.cover,</span><br><span class="line">              ),</span><br><span class="line"></span><br><span class="line">              titleSection,</span><br><span class="line">              buttonSection,</span><br><span class="line">              textSection</span><br><span class="line">            ],</span><br><span class="line">          ),</span><br><span class="line">      )</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>现在，如果没有出错的话，运行后应该就可以看到下面这个页面。<br><img src="/2018/08/26/flutter-ui-basic/Screenshot_20180826-172022.png" alt=""></p>
<p>如果你遇到了麻烦，可以在这里找到所有的源码：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/Jekton/flutter_demo.git</span><br><span class="line">cd flutter_demo</span><br><span class="line">git checkout ui-basic1</span><br></pre></td></tr></table></figure>

<p>更多的布局知识，读者还可以参考 <a href="https://flutter.io/tutorials/layout/" target="_blank" rel="noopener">https://flutter.io/tutorials/layout/</a>。</p>
<h1 id="示例二"><a href="#示例二" class="headerlink" title="示例二"></a>示例二</h1><p>在这一小节我们来实现一个 list view。</p>
<p><img src="/2018/08/26/flutter-ui-basic/listview.png" alt=""></p>
<p>这里我们采用的还是官网提供的例子，但是换一种方式来实现，让它跟我们平时使用 Java 时更像一些。</p>
<p>首先给数据建模：</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">enum</span> BuildingType &#123; theater, restaurant &#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Building</span> </span>&#123;</span><br><span class="line">  <span class="keyword">final</span> BuildingType type;</span><br><span class="line">  <span class="keyword">final</span> <span class="built_in">String</span> title;</span><br><span class="line">  <span class="keyword">final</span> <span class="built_in">String</span> address;</span><br><span class="line"></span><br><span class="line">  Building(<span class="keyword">this</span>.type, <span class="keyword">this</span>.title, <span class="keyword">this</span>.address);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>然后实现每个 item 的 UI：</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ItemView</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="keyword">final</span> <span class="built_in">int</span> position;</span><br><span class="line">  <span class="keyword">final</span> Building building;</span><br><span class="line"></span><br><span class="line">  ItemView(<span class="keyword">this</span>.position, <span class="keyword">this</span>.building);</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">final</span> icon = Icon(</span><br><span class="line">        building.type == BuildingType.restaurant</span><br><span class="line">            ? Icons.restaurant</span><br><span class="line">            : Icons.theaters,</span><br><span class="line">        color: Colors.blue[<span class="number">500</span>]);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">final</span> widget = Row(</span><br><span class="line">      children: &lt;Widget&gt;[</span><br><span class="line">        Container(</span><br><span class="line">          margin: EdgeInsets.all(<span class="number">16.0</span>),</span><br><span class="line">          child: icon,</span><br><span class="line">        ),</span><br><span class="line">        Expanded(</span><br><span class="line">          child: Column(</span><br><span class="line">            crossAxisAlignment: CrossAxisAlignment.start,</span><br><span class="line">            children: &lt;Widget&gt;[</span><br><span class="line">              Text(</span><br><span class="line">                building.title,</span><br><span class="line">                style: TextStyle(</span><br><span class="line">                  fontSize: <span class="number">20.0</span>,</span><br><span class="line">                  fontWeight: FontWeight.w500,</span><br><span class="line">                )</span><br><span class="line">              ),</span><br><span class="line">              Text(building.address)</span><br><span class="line">            ],</span><br><span class="line">          ),</span><br><span class="line">        )</span><br><span class="line">      ],</span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> widget;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>接着是 ListView。由于渲染机制不同，这里没必要弄个 adapter 来管理 widget：</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BuildingListView</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="keyword">final</span> <span class="built_in">List</span>&lt;Building&gt; buildings;</span><br><span class="line"></span><br><span class="line">  BuildingListView(<span class="keyword">this</span>.buildings);</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="comment">// ListView.builder 可以按需生成子控件</span></span><br><span class="line">    <span class="keyword">return</span> ListView.builder(</span><br><span class="line">      itemCount: buildings.length,</span><br><span class="line">      itemBuilder: (context, index) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ItemView(index, buildings[index]);</span><br><span class="line">      &#125;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>现在，我们来给 item 加上点击事件。</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 定义一个回调接口</span></span><br><span class="line"><span class="keyword">typedef</span> OnItemClickListener = <span class="keyword">void</span> <span class="built_in">Function</span>(<span class="built_in">int</span> position);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ItemView</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">final</span> <span class="built_in">int</span> position;</span><br><span class="line">  <span class="keyword">final</span> Building building;</span><br><span class="line">  <span class="keyword">final</span> OnItemClickListener listener;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 这里的 listener 会从 ListView 那边传过来</span></span><br><span class="line">  ItemView(<span class="keyword">this</span>.position, <span class="keyword">this</span>.building, <span class="keyword">this</span>.listener);</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">final</span> widget = ...;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 一般来说，为了监听手势事件，我们使用 GestureDetector。但这里为了在点击的时候有个</span></span><br><span class="line">    <span class="comment">// 水波纹效果，使用的是 InkWell。</span></span><br><span class="line">    <span class="keyword">return</span> InkWell(</span><br><span class="line">      onTap: () =&gt; listener(position),</span><br><span class="line">      child: widget</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BuildingListView</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="keyword">final</span> <span class="built_in">List</span>&lt;Building&gt; buildings;</span><br><span class="line">  <span class="keyword">final</span> OnItemClickListener listener;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 这是对外接口。外部通过构造函数传入数据和 listener</span></span><br><span class="line">  BuildingListView(<span class="keyword">this</span>.buildings, <span class="keyword">this</span>.listener);</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> ListView.builder(</span><br><span class="line">      itemCount: buildings.length,</span><br><span class="line">      itemBuilder: (context, index) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ItemView(index, buildings[index], listener);</span><br><span class="line">      &#125;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>最后加上一些脚手架代码，我们的列表就能够跑起来了：</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> main() &#123;</span><br><span class="line">  runApp(MyApp());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyApp</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">final</span> buildings = [</span><br><span class="line">      Building(BuildingType.theater, <span class="string">'CineArts at the Empire'</span>, <span class="string">'85 W Portal Ave'</span>),</span><br><span class="line">      Building(BuildingType.theater, <span class="string">'The Castro Theater'</span>, <span class="string">'429 Castro St'</span>),</span><br><span class="line">      Building(BuildingType.theater, <span class="string">'Alamo Drafthouse Cinema'</span>, <span class="string">'2550 Mission St'</span>),</span><br><span class="line">      Building(BuildingType.theater, <span class="string">'Roxie Theater'</span>, <span class="string">'3117 16th St'</span>),</span><br><span class="line">      Building(BuildingType.theater, <span class="string">'United Artists Stonestown Twin'</span>, <span class="string">'501 Buckingham Way'</span>),</span><br><span class="line">      Building(BuildingType.theater, <span class="string">'AMC Metreon 16'</span>, <span class="string">'135 4th St #3000'</span>),</span><br><span class="line">      Building(BuildingType.restaurant, <span class="string">'K\'s Kitchen'</span>, <span class="string">'1923 Ocean Ave'</span>),</span><br><span class="line">      Building(BuildingType.restaurant, <span class="string">'Chaiya Thai Restaurant'</span>, <span class="string">'72 Claremont Blvd'</span>),</span><br><span class="line">      Building(BuildingType.restaurant, <span class="string">'La Ciccia'</span>, <span class="string">'291 30th St'</span>),</span><br><span class="line"></span><br><span class="line">      <span class="comment">// double 一下</span></span><br><span class="line">      Building(BuildingType.theater, <span class="string">'CineArts at the Empire'</span>, <span class="string">'85 W Portal Ave'</span>),</span><br><span class="line">      Building(BuildingType.theater, <span class="string">'The Castro Theater'</span>, <span class="string">'429 Castro St'</span>),</span><br><span class="line">      Building(BuildingType.theater, <span class="string">'Alamo Drafthouse Cinema'</span>, <span class="string">'2550 Mission St'</span>),</span><br><span class="line">      Building(BuildingType.theater, <span class="string">'Roxie Theater'</span>, <span class="string">'3117 16th St'</span>),</span><br><span class="line">      Building(BuildingType.theater, <span class="string">'United Artists Stonestown Twin'</span>, <span class="string">'501 Buckingham Way'</span>),</span><br><span class="line">      Building(BuildingType.theater, <span class="string">'AMC Metreon 16'</span>, <span class="string">'135 4th St #3000'</span>),</span><br><span class="line">      Building(BuildingType.restaurant, <span class="string">'K\'s Kitchen'</span>, <span class="string">'1923 Ocean Ave'</span>),</span><br><span class="line">      Building(BuildingType.restaurant, <span class="string">'Chaiya Thai Restaurant'</span>, <span class="string">'72 Claremont Blvd'</span>),</span><br><span class="line">      Building(BuildingType.restaurant, <span class="string">'La Ciccia'</span>, <span class="string">'291 30th St'</span>),</span><br><span class="line">    ];</span><br><span class="line">    <span class="keyword">return</span> MaterialApp(</span><br><span class="line">      title: <span class="string">'ListView demo'</span>,</span><br><span class="line">      home: Scaffold(</span><br><span class="line">        appBar: AppBar(</span><br><span class="line">          title: Text(<span class="string">'Buildings'</span>),</span><br><span class="line">        ),</span><br><span class="line">        body: BuildingListView(buildings, (index) =&gt; debugPrint(<span class="string">'item $index clicked'</span>))</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这个时候你应该可以看到像这样的界面了：<br><img src="/2018/08/26/flutter-ui-basic/screenshot-listview.png" alt=""></p>
<p>如果你遇到了什么麻烦，可以查看 tag ui-basic2 的代码：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/Jekton/flutter_demo.git</span><br><span class="line">cd flutter_demo</span><br><span class="line">git checkout ui-basic2</span><br></pre></td></tr></table></figure>

</div><div class="tags"><a href="/tags/Flutter/">Flutter</a></div><div class="post-nav"><a class="pre" href="/2018/08/29/flutter-ux-basic/">Flutter 开发（3）- 交互、动画、手势和事件处理</a><a class="next" href="/2018/08/26/flutter-first-app/">Flutter 开发（1）- 开发框架、流程、编译打包、调试</a></div><div id="disqus_thread"><div class="btn_click_load"><button class="disqus_click_btn">阅读评论（请确保 Disqus 可以正常加载）</button></div><script type="text/javascript">var disqus_config = function () {
    this.page.url = 'https://jekton.github.io/2018/08/26/flutter-ui-basic/';
    this.page.identifier = '2018/08/26/flutter-ui-basic/';
    this.page.title = 'Flutter 开发（2）- UI控件和布局';
  };</script><script type="text/javascript" id="disqus-lazy-load-script">$.ajax({
url: 'https://disqus.com/next/config.json',
timeout: 2500,
type: 'GET',
success: function(){
  var d = document;
  var s = d.createElement('script');
  s.src = '//jekton-github-io.disqus.com/embed.js';
  s.setAttribute('data-timestamp', + new Date());
  (d.head || d.body).appendChild(s);
  $('.disqus_click_btn').css('display', 'none');
},
error: function() {
  $('.disqus_click_btn').css('display', 'block');
}
});</script><script type="text/javascript" id="disqus-click-load">$('.btn_click_load').click(() => {  //click to load comments
    (() => { // DON'T EDIT BELOW THIS LINE
        var d = document;
        var s = d.createElement('script');
        s.src = '//jekton-github-io.disqus.com/embed.js';
        s.setAttribute('data-timestamp', + new Date());
        (d.head || d.body).appendChild(s);
    })();
    $('.disqus_click_btn').css('display','none');
});</script><script type="text/javascript" id="disqus-count-script">$(function() {
     var xhr = new XMLHttpRequest();
     xhr.open('GET', '//disqus.com/next/config.json', true);
     xhr.timeout = 2500;
     xhr.onreadystatechange = function () {
       if (xhr.readyState === 4 && xhr.status === 200) {
         $('.post-meta .post-comments-count').show();
         var s = document.createElement('script');
         s.id = 'dsq-count-scr';
         s.src = 'https://jekton-github-io.disqus.com/count.js';
         s.async = true;
         (document.head || document.body).appendChild(s);
       }
     };
     xhr.ontimeout = function () { xhr.abort(); };
     xhr.send(null);
   });
</script></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Android/">Android</a><span class="category-list-count">29</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Dart/">Dart</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Flutter/">Flutter</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/JVM/">JVM</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Java/">Java</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Linux/">Linux</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/读书笔记/">读书笔记</a><span class="category-list-count">1</span></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/Android-arch/" style="font-size: 15px;">Android arch</a> <a href="/tags/Android/" style="font-size: 15px;">Android</a> <a href="/tags/Binder/" style="font-size: 15px;">Binder</a> <a href="/tags/parallel-programming/" style="font-size: 15px;">parallel-programming</a> <a href="/tags/Java/" style="font-size: 15px;">Java</a> <a href="/tags/synchronized/" style="font-size: 15px;">synchronized</a> <a href="/tags/openjdk/" style="font-size: 15px;">openjdk</a> <a href="/tags/读书笔记/" style="font-size: 15px;">读书笔记</a> <a href="/tags/Linux/" style="font-size: 15px;">Linux</a> <a href="/tags/Android-source/" style="font-size: 15px;">Android source</a> <a href="/tags/Dart/" style="font-size: 15px;">Dart</a> <a href="/tags/Flutter/" style="font-size: 15px;">Flutter</a> <a href="/tags/Handler/" style="font-size: 15px;">Handler</a> <a href="/tags/杂谈/" style="font-size: 15px;">杂谈</a> <a href="/tags/logd/" style="font-size: 15px;">logd</a> <a href="/tags/JDK/" style="font-size: 15px;">JDK</a> <a href="/tags/native-crash/" style="font-size: 15px;">native-crash</a> <a href="/tags/Glide/" style="font-size: 15px;">Glide</a> <a href="/tags/Socket/" style="font-size: 15px;">Socket</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最近文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2019/07/08/android-scrollview-impl/">ScrollView 实现指北</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/05/26/java-multi-singleton/">如何使用 Java 和 double-check 实现支持多实例的单例</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/04/06/native-crash-catching/">Android native 崩溃信息捕获实践</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/03/21/android9-lmk-lmkd/">Android P 源码分析 5 - Low memory killer 之 lmkd 守护进程</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/03/20/android9-logd-init/">Android P 源码分析 4 - logd 的初始化</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/03/19/android9-sp/">Android P 源码分析 3 - SharedPreferences 源码分析</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/03/12/android9-sp-wp/">Android P 源码分析 2 - 强弱指针的实现</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/03/06/android9-light-sp/">Android P 源码分析 1 - 轻量级智能指针的实现</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/12/15/linux-wait-event/">Java 程序员眼里的 Linux 内核 —— wait_event 源码分析</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/11/18/linux-page-table-setup/">Linux 内核页表的创建</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-comment-o"> 最近评论</i></div><script type="text/javascript" src="//jekton-github-io.disqus.com/recent_comments_widget.js?num_items=5&amp;hide_avatars=1&amp;avatar_size=32&amp;excerpt_length=20&amp;hide_mods=1"></script></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2019 <a href="/." rel="nofollow">程序员虾饺.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/3.3.5/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/3.3.5/jquery.fancybox.min.css"><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>